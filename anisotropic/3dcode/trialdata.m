%coeff1r=[-3.5448,-1,-2,0,-2,-1.75];
%coeff2r=[-3.5448,0,-1,-2,1,0];

%coeff10=[-3.5448,-1,-2,0,-2,-1.75]+[0,.3,-.6,.3,.2,.5];
%coeff20=[-3.5448,0,-1,-2,1,0]+[0,.5,-.5,.1,.3,.2];

%coeff1=[-3.5448, -8.2765  ,-7.5977  , 15.4433 ,   1.0832 ,  -3.1602];
%coeff2=[-3.5448   -0.3423    0.0438  -12.8393  -13.3536   -4.2035];

%coeff1=[-3.5448,   -1.3435,   -2.6628,   -0.0086,   -2.3824,   -1.3765];
%coeff2=[-3.5448,    0.3758,   -1.9140,   -1.9734,    0.7459,    0.2652];
coeff1r=[-3.5448,-1,-2,0,-2,-1];
coeff2r=[-3.5448,0,-1,-1,1,0];

coeff10=[-3.5448,0,0,0,0,0];
coeff20=[-3.5448,0,0,0,0,0];

coeff1 =[-3.5448,-7.1339,-5.4770,0.1102,-7.0891,-0.7241];
coeff2=[-3.5448, -1.3586, -4.2245, -0.9881,-1.6157 , 1.2324];

coeff1 =[-3.5448,-1.2278,-1.0139,0.2015,-1.5342,-0.9339];
coeff2=[-3.5448 , 0,1.1719,-0.5739,-0.4151,0.7901];
%u = tdphysicalK3d(t,0.001,u0,coeff1w,coeff2w);

N1=4;
N2=3;
sizeu=64;
u0=zeros(N1,64,64,64);
u0(1,:,:,:) = getsphere(64,20);
u0(2,:,:,:)= getellipsoid(64,25,15,15,pi/4,pi/4,pi/4);
u0(3,:,:,:)= getellipsoid(64,25,25,15,0,0,0);
u0(4,:,:,:)= getellipsoid(64,15,20,25,0,0,0);
t=[10,20,30];

data=zeros(4,3,64,64,64);
for k=1:N1
    for i=1:N2
        data(k,i,:,:,:) = tdphysicalK3d(t(i),0.001,reshape(u0(k,:,:,:),[sizeu sizeu sizeu]),coeff1r,coeff2r);
    end
end
